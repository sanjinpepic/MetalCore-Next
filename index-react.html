<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MetalCore - Premium Metallurgy</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                        display: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        obsidian: '#0a0a0b',
                        glass: 'rgba(255, 255, 255, 0.05)',
                        'glass-hover': 'rgba(255, 255, 255, 0.1)',
                        accent: '#f59e0b',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;700&family=Outfit:wght@700;900&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="src/styles/main.css">
</head>

<body>
    <div id="error-overlay"></div>
    <div id="loading">
        <div class="spinner"></div>
        <h2 class="text-xl font-bold text-white mb-2">Initialize MetalCore</h2>
        <p class="text-xs text-slate-500 font-mono">Loading local resources...</p>
    </div>
    <div id="root"></div>

    <!-- LOCAL LIBRARIES -->
    <script src="libs/react.js"></script>
    <script src="libs/react-dom.js"></script>
    <script src="libs/recharts.js"></script>
    <script src="libs/prop-types.js"></script>
    <script src="libs/classnames.js"></script>
    <script src="libs/babel.js"></script>
    <script src="libs/lucide.js"></script>
    <script src="libs/xlsx.js"></script>

    <script type="module">
        import { GoogleGenerativeAI } from 'https://esm.run/@google/generative-ai';
        window.GoogleGenerativeAI = GoogleGenerativeAI;
    </script>

    <script>
        // Global Error Handler
        window.onerror = function (msg, url, line, col, error) {
            const el = document.getElementById('error-overlay');
            el.style.display = 'block';
            el.innerHTML += `<div style="margin-bottom:20px; border-left: 2px solid #ef4444; padding-left: 10px;">
                <h3 style="font-weight:bold; margin-bottom:5px;">System Error</h3>
                <p style="margin-bottom:5px;">${msg}</p>
                <small style="opacity:0.6;">${url}:${line}</small>
            </div>`;
            return false;
        };

        // Pre-check libs
        window.addEventListener('load', () => {
            const missing = [];
            if (!window.React) missing.push('React');
            if (!window.ReactDOM) missing.push('ReactDOM');
            if (!window.Babel) missing.push('Babel');

            const hasRecharts = window.Recharts || (window.Recharts && window.Recharts.default) || window._Recharts;
            if (!hasRecharts) missing.push('Recharts');

            if (missing.length > 0) {
                const el = document.getElementById('error-overlay');
                el.style.display = 'block';
                el.innerHTML += `<div style="padding: 20px; border: 1px solid #333; border-radius: 8px;">
                    <h1 style="font-size: 24px; color: white; margin-bottom: 10px;">Setup Incomplete</h1>
                    <p>Some local library files are missing or empty:</p>
                    <ul style="list-style: disc; margin-left: 20px; margin-top: 10px; color: #94a3b8;">
                        ${missing.map(m => `<li>${m}</li>`).join('')}
                    </ul>
                    <p style="margin-top: 20px; font-size: 12px; color: #64748b;">Debug info: Check console for detailed object dump.</p>
                 </div>`;
            }
        });
    </script>

    <!-- React Application -->
    <script type="text/babel" src="src/App.jsx"></script>
</body>

</html>